# -*- coding: utf-8 -*-
"""Fantasy_25_master_dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1pvl8nBgxYMZsJ_zNGxp4XNcpbqwrSXD9
"""

cd $(find ~ -type d -name "NFL-Data" -maxdepth 4 2>/dev/null | head -n 1)

rm -rf NFL-Weekly-Offense-2025
mkdir -p NFL-Weekly-Offense-2025/{QB,RB,WR,TE,K}

for wdir in NFL-data-Players/2025/*/; do
  week=$(basename "$wdir")
  for pos in QB RB WR TE K; do
    file="$wdir/$pos.csv"
    if [ -f "$file" ]; then
      cp "$file" "NFL-Weekly-Offense-2025/$pos/${week}.csv"
    fi
  done
done

python3 - <<'PY'
import os
import re
import pandas as pd

BASE = "NFL-Weekly-Offense-2025"
OUT  = "NFL-Weekly-Offense-2025_ALL_QB_RB_WR_TE_K_weeks1-18.csv"
POS  = ["QB","RB","WR","TE","K"]

def week_num(name: str):
    m = re.search(r'(\d+)', name)
    return int(m.group(1)) if m else None

dfs = []
for pos in POS:
    pdir = os.path.join(BASE, pos)
    if not os.path.isdir(pdir):
        continue
    for fn in sorted(os.listdir(pdir)):
        if not fn.lower().endswith(".csv"):
            continue
        wk = week_num(os.path.splitext(fn)[0])
        if wk is None or not (1 <= wk <= 18):
            continue
        path = os.path.join(pdir, fn)
        df = pd.read_csv(path)
        df.insert(0, "position", pos)
        df.insert(1, "week", wk)
        dfs.append(df)

if not dfs:
    raise SystemExit(f"No week 1â€“18 CSVs found under {BASE}/{{QB,RB,WR,TE,K}}")

out = pd.concat(dfs, ignore_index=True, sort=False)
out.to_csv(OUT, index=False)
print("Rows:", len(out))
print("Saved:", OUT)
PY

python3 - <<'PY'
import pandas as pd

input_file = "NFL-Weekly-Offense-2025_ALL_QB_RB_WR_TE_K_weeks1-18.csv"
output_file = "fantasy_2025_all_players_FINAL.csv"

cols_to_drop = [
    "PlayerId","Pos","PassingYDS","PassingTD","PassingInt",
    "RushingYDS","RushingTD","ReceivingRec","ReceivingYDS","ReceivingTD",
    "RetTD","FumTD","2PT","Fum","FanPtsAgainst-pts",
    "TouchCarries","TouchReceptions","Touches","TargetsReceptions","Targets",
    "ReceptionPercentage","RzTarget","RzTouch","RzG2G",
    "PatMade","PatMissed",
    "FgMade_0-19","FgMade_20-29","FgMade_30-39","FgMade_40-49","FgMade_50",
    "FgMiss_0-19","FgMiss_20-29","FgMiss_30-39",
    "PlayerOpponent"
]

df = pd.read_csv(input_file)
df = df.drop(columns=[c for c in cols_to_drop if c in df.columns])
df.to_csv(output_file, index=False)

print("Saved final cleaned file as:", output_file)
PY

open NFL-Weekly-Offense-2025
open fantasy_2025_all_players_FINAL.csv